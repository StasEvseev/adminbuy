<div class="top-bar">

    <div class="content-header">

        <h1>
            Накладные прихода
            <small></small>
        </h1>

        <ol class="breadcrumb" ui-view>
            <li><a ui-sref="index.dash"><i class="fa fa-dashboard"></i> Дом</a></li>
            <li><a ui-sref="index.invoice_in.list">Накладные</a></li>
            <li class="active">Создание пачки</li>
        </ol>


        <div class="btn-custom-group">
            <div class="row">
                <div class="col-md-6 col-sm-6 col-xs-6 ng-scope">
                    <span>
                        <button class="btn-edt btn-flat btn btn-primary btn-sm" ng-click="save()">Создать пачку</button>
                        <button class="btn-edt btn-flat btn btn-warning btn-sm" ng-click="cancel()">Отмена</button>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!--<header style="background-color: bisque; min-height: 40px; padding: 8px 8px 8px 0px;">
        <div>
            <ul class="pull-right status-bar" style="float:right;">
                <li class="status-item" ng-class="{'active': model.status == 1 || model.status == undefined}"
                    style="  display: inline-block; border: 1px solid #c8c8d3; padding-left: 0px;">
                    <span>Новая</span>
                </li>
                <li class="status-item" ng-class="{'active': model.status == 2}"
                    style="  display: inline-block; border: 1px solid #c8c8d3; padding-left: 0px;">
                    <span>Формирование</span>
                </li>
                <li class="status-item" ng-class="{'active': model.status == 3}"
                    style="  display: inline-block; border: 1px solid #c8c8d3; padding-left: 0px;">
                    <span>Доставка</span>
                </li>
                <li class="status-item active" ng-class="{'active': model.status == 4}"
                    style="  display: inline-block; border: 1px solid #c8c8d3; padding-left: 0px;">
                    <span>Завершено</span>
                </li>
            </ul>
        </div>

    </header>-->

</div>


<!-- Main content -->
<div class="main-content" my-auto-padding>
    <span ng-cloak ng-hide="loadingFinish" class="spinner">
        <span us-spinner="{lines: 13, length: 5, width: 2, radius: 5}" class="ng-scope"><div class="spinner" role="progressbar" style="position: absolute; width: 0px; z-index: 2000000000; left: 50%; top: 50%;"><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-0-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-0-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(0deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-1-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-1-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(27deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-2-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-2-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(55deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-3-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-3-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(83deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-4-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-4-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(110deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-5-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-5-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(138deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-6-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-6-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(166deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-7-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-7-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(193deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-8-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-8-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(221deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-9-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-9-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(249deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-10-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-10-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(276deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-11-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-11-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(304deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; -webkit-animation: opacity-100-25-12-13 1s linear infinite; animation-duration: 1s; animation-timing-function: linear; animation-delay: initial; animation-iteration-count: infinite; animation-direction: initial; animation-fill-mode: initial; -webkit-animation-play-state: initial; animation-play-state: initial; animation-name: opacity-100-25-12-13;"><div style="position: absolute; width: 7px; height: 2px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 1px; -webkit-transform-origin: left 50% 0px; -webkit-transform: rotate(332deg) translate(5px, 0px); border-radius: 1px; background: rgb(0, 0, 0);"></div></div></div></span>
    </span>
    <section class="invoice">
        <form name="myForm.item">
            <!-- title row -->
            <div class="row">
                <div class="col-xs-12">
                    <h2 class="page-header">
                        <i class="fa fa-globe"></i> [[nameInvoice]]
                        <!--<small class="pull-right">Дата: [[ item.date | date:'d MMM y' ]]</small>-->
                    </h2>
                </div>
                <!-- /.col -->
            </div>
            <!-- info row -->
            <div class="row invoice-info">
                <div class="col-sm-6 invoice-col">


                    <div class="form-group">
                        <label>Дата накладной</label>

                        <div class="input-group">

                            <div ng-click="open($event)" class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>

                            <input type="text" class="form-control"
                                   datepicker-popup="yyyy-MM-dd"
                                   name="date"
                                   ng-model="model.date"
                                   is-open="status.opened"
                                   min-date="minDate"
                                   max-date="'2020-06-22'"
                                   datepicker-options="dateOptions"
                                   date-disabled="disabled(date, mode)"
                                   ng-required="true"
                                   close-text="Закрыть" />
                        </div>
                    </div>
                </div>
                <!-- /.col -->
                <div class="col-sm-6 invoice-col">

                    <div class="form-group">
                        <label for="typeRec">Тип получателя</label>

                        <div id="typeRec">
                            <label>
                                <input type="radio" ng-model="model.typeRec" value="1" name="r3" />
                                Торговая точка
                            </label><br/>
                            <label>
                                <input type="radio" ng-model="model.typeRec" value="2" name="r3" />
                                Оптовик
                            </label>
                        </div>
                    </div>
                </div>
                <!-- /.col -->
                <!--<div class="col-sm-2 invoice-col">

                    <div class="form-group">
                        <label for="type">Тип накладной</label>

                        <div id="type">
                            <label>
                                <input type="radio" ng-model="model.type" value="1" name="r2" />
                                <span>Оптовая</span>
                            </label><br/>
                            <label>
                                <input type="radio" ng-model="model.type" value="2" name="r2" />
                                Розничная
                            </label>
                        </div>
                    </div>
                </div>-->
                <!-- /.col -->
            </div>
            <!-- /.row -->

            <div class="row invoice-info">

                <div class="col-sm-6 invoice-col">
                    <div class="form-group" ng-class="{'has-error':  Form.isSubmitted() && myForm.item.pointsale_from.$error.required}">
                        <label for="exampleInputPassword1">Торговая точка отправитель</label>

                        <dict-select-field

                                ng-model="model.pointSource"
                                service="PointService"
                                lazy="true"
                                select="model.pointsale_from_id"
                                style="width: 100%"
                                dng-required="true"
                                dname="pointsale_from"
                                >
                            <dict-select-field-match placeholder="Введите название...">[[$select.selected.name]]</dict-select-field-match>
                            <dict-select-field-choices repeat="item in $items | propsFilter: {name: $select.search}">
                                <div ng-bind-html="item.name | highlight: $select.search"></div>
                            </dict-select-field-choices>
                        </dict-select-field>

                    </div>
                    <address>
                        Адрес: [[model.pointSource.address]]
                    </address>
                </div>

                <div ng-show="model.typeRec == 2" class="col-sm-6 invoice-col">
                    <div class="form-group" ng-class="{'has-error': Form.isSubmitted() && myForm.item.receiver.$error.required}">
                        <label for="exampleInputPassword1">Оптовики</label>

                        <dict-select-field
                                multiple="true"
                                ng-model="model.Receiver"
                                service="ReceiverService"
                                lazy="true"
                                select="model.receiver_id"
                                dname="receiver"
                                dng-required='model.typeRec == 2'
                                style="width: 100%"
                                can-edit="false"
                                can-create="false">
                            <dict-select-field-match placeholder="Введите имя...">[[$item.fullname]]</dict-select-field-match>
                            <dict-select-field-choices repeat="item in $items | propsFilter: {fullname: $select.search}">
                                <div ng-bind-html="item.fullname | highlight: $select.search"></div>
                            </dict-select-field-choices>
                        </dict-select-field>
                    </div>
                </div>

                <div ng-show="model.typeRec == 1" class="col-sm-5 invoice-col">
                    <div class="form-group" ng-class="{'has-error':  Form.isSubmitted() && myForm.item.pointsale.$error.required}">
                        <label for="exampleInputPassword1">Торговые точки получатели</label>

                        <dict-select-field
                                multiple="true"
                                ng-model='model.pointReceiver'
                                service='PointService'
                                lazy='true'
                                select='model.pointsale_id'
                                dname='pointsale'
                                dng-required="model.typeRec == 1"

                                style="width: 100%"
                                can-edit="false"
                                can-create="false">
                            <dict-select-field-match placeholder="Введите название...">[[$item.name]]</dict-select-field-match>
                            <dict-select-field-choices repeat="item in $items | propsFilter: {name: $select.search}">
                                <div ng-bind-html="item.name | highlight: $select.search"></div>
                            </dict-select-field-choices>
                        </dict-select-field>
                    </div>
                </div>
            </div>

            <!-- Table row -->
            <div class="row">
                <div class="col-xs-12 table-responsive">
                    <table class="table table-striped table-local" model-table ng-model="model.items">
                        <thead>
                        <tr header-fixed-scroll style="background-color: brown">
                            <th>Наименование</th>
                            <th>Цена</th>
                            <th>Действия</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="row in model.items">
                            <td>[[ row.good.full_name ]]</td>
                            <td ng-bind-html="row.good.price.price_retail | rub" ng-show="model.typeRec == 1"></td>
                            <td ng-bind-html="row.good.price.price_gross | rub" ng-show="model.typeRec == 2"></td>
                            <td><a style="cursor:pointer;" ng-click="removeRow(row)">Удалить</a></td>
                        </tr>
                        <tr>
                            <td colspan="4">
                                <a style="cursor: pointer" ng-click="openWindowSelect()">
                                    <span style="color: #00a65a; border-bottom: 1px dotted">
                                        Добавить из накладной
                                    </span>
                                </a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <!-- /.col -->
            </div>
        </form>
    </section>
</div>

